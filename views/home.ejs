<!DOCTYPE html>
<html lang="en">
<head>
    <title>HotOffThePress</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
</head>

<body>
    <div class="banner">
        <!-- nebula particles layer (pure CSS) -->
        <div class="nebula-particles" aria-hidden="true"></div>
        <div class="navbar">
            <div class="logo">
                <video class="logo-video" autoplay loop muted playsinline>
                    <source src="/videos/video.mp4" type="video/mp4">
                </video>
            </div>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/submissions/create">Submit Story</a></li>
                <li><a href="/submissions">All Submissions</a></li>
                 <li class="nav-dropdown">
                   <a href="/users/account" class="dropbtn">My Account ▾</a>
                   <ul class="dropdown-menu">
                     <li><a href="/users/account">Account</a></li>
                     <li><a href="/submissions/mine"> My Submissions</a></li>
                     <li><a href="/users/logout">Logout</a></li>
                   </ul>
                 </li>
                <li><a href="/aisupport">AI Support</a></li>
                <li><a href="/faq">FAQ</a></li>
                <li><a href="/about">About Us</a></li>
            </ul>
        </div>

        <div class="content">
            <h2>Welcome to Hot Off The Press, <strong><%= user.username %></strong>! <img src="https://pixelsafari.neocities.org/favicon/animals/cat/cat42.gif" > </h2>

            <h3>Latest Hacker Stories</h3>
        </div>
        <div class="hackerstories">
            <% if (hnStories && hnStories.length) { %>
              <ol>
                <% hnStories.forEach(function(s) { %>
                  <li style="margin:10px 0; text-align:left; color:inherit;">
                    <a href="<%= s.url || ('https://news.ycombinator.com/item?id=' + s.hnId) %>" 
                       target="_blank" rel="noopener noreferrer"
                       style="color:inherit; text-decoration:underline;">
                      <strong><%= s.title %></strong>
                    </a>
                    <div style="font-size:0.9em; opacity:0.8;">
                      by <%= s.by %> • <%= new Date(s.time * 1000).toLocaleString() %> • score: <%= s.score %>
                    </div>

                    <% if (s.text) { %>
                      <div style="margin-top:6px; font-size:0.95em; opacity:0.9;"><%= s.text %></div>
                    <% } %>
                  </li>
                <% }); %>
              </ol>
            <% } else { %>
              <div id="stories-placeholder">
                  <p>Stories will appear here soon!</p>
              </div>
            <% } %>

        </div>
    </div>

    <!-- inline particle script: glowing falling bits -->
    <script>
    (function createNebulaBits(){
      const container = document.querySelector('.nebula-particles');
      if (!container) return;

      const CHARS = '01abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()-_=+[]{}<>?/|\\';
      const COUNT = 36;

      function rand(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
      function randChoice(s){ return s.charAt(Math.floor(Math.random()*s.length)); }
      function makeText(len){
        let out = '';
        if (Math.random() < 0.28) {
          for(let i=0;i<len;i++) out += (Math.random()<0.6 ? (Math.random()<0.6 ? '0' : '1') : randChoice('0123456789'));
        } else {
          for(let i=0;i<len;i++) out += randChoice(CHARS);
        }
        return out;
      }

      function spawnBit(i){
        const span = document.createElement('span');
        span.className = 'nebula-bit';
        if (Math.random() < 0.26) span.classList.add('alt');

        const len = rand(1,6);
        span.textContent = makeText(len);

        const left = Math.max(0, Math.min(98, Math.round((i/(COUNT-1))*98 + (Math.random()*5-2.5))));
        span.style.left = left + '%';

        const size = rand(10,26);
        span.style.setProperty('--size', size + 'px');

        const hue = rand(200,270);
        const sat = rand(70,95);
        const light = rand(60,85);
        span.style.setProperty('--col', `hsl(${hue} ${sat}% ${light}%)`);

        const dur = (rand(7,18)) + 's';
        const delay = (-Math.random()*12).toFixed(2) + 's';
        span.style.setProperty('--dur', dur);
        span.style.setProperty('--delay', delay);

        span.style.transform = `translateY(-120%) rotate(${(Math.random()*8-4).toFixed(2)}deg)`;

        container.appendChild(span);

        setTimeout(()=> {
          if (span && span.parentNode) span.parentNode.removeChild(span);
        }, (parseFloat(dur) + 5) * 1000);
      }

      for(let i=0;i<COUNT;i++) spawnBit(i);

      setInterval(()=>{
        const toSpawn = rand(3,7);
        for(let j=0;j<toSpawn;j++){
          spawnBit(rand(0,COUNT-1));
        }
      }, 2500);

    })();
    </script>
  </body>
</html>
